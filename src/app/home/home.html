<div class="items-container" infinite-scroll (scrolled)="onScroll()">
  <!-- <button (click)="testPrint()">Test Print</button> -->
  @for (item of items; track item.id) {
    <div class="item-card">
      @if (item.tags && item.tags.length > 0) {
        <div class="tag-list">
          @for (tag of item.tags; track $index) {
            <span class="tag-pill">{{ tag }}</span>
          }
        </div>
      }
      @if (item.type === 'link') {
        <blockquote 
            class="twitter-tweet" 
            data-media-max-width="560"
            data-width="450"  >
          <a [href]="item.url"></a>
        </blockquote> 
      }
      @if (item.type === 'file') {
        <p>File ID: {{ item.file_id }}</p>
      }
      <div class="card-actions">
        <button class="delete-button" type="button" (click)="confirmDelete(item)" title="Delete Item">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="delete-icon">
            <path d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-4.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"/>
          </svg>
        </button>
      </div>
    </div>
  }

  @if (loading && items.length === 0) {
    @for (i of [1, 2, 3, 4, 5]; track i) {
      <div class="item-card skeleton-card">
        <div class="skeleton-line skeleton-header"></div>

        <div class="skeleton-image"></div>

        <div class="skeleton-line skeleton-body-short"></div>
        <div class="skeleton-line skeleton-body-long"></div>

        <div class="skeleton-footer-section">
          <div class="skeleton-tag"></div>
          <div class="skeleton-tag"></div>
        </div>
      </div>
    }
  }

  <div class="scroll-status-footer">
    @if (loading) {
      <div class="loading-spinner-container">
        <div class="spinner"></div>
      </div>
    } @else if (!hasNextPage && items.length > 0) {
      <div class="end-of-page-message">
        <p>--- You've reached the end of the line! ---</p>
      </div>
    }
  </div>
</div>

@if (showDeleteConfirmation) {
  <div class="modal-backdrop" (click)="cancelDelete()"></div>
  <div class="modal-dialog">
    <div class="modal-header">
      <h3>Confirm Deletion</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to delete this item? This action cannot be undone.</p>
    </div>
    <div class="modal-footer">
      <button class="modal-button modal-cancel-button" (click)="cancelDelete()">
        Cancel
      </button>
      <button class="modal-button modal-confirm-button" (click)="deleteItem()">
        Delete
      </button>
    </div>
  </div>
}
